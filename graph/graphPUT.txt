graph TD
A[producer] --> B[Début de la boucle while !done]
B --> C[Initialiser les variables]
C --> D[Attendre les sémaphores -> sem_driver, sem_military, et sem_material]
D --> E[Verrouiller mutex_convoi_id]
E --> F[Générer un convoi_id unique]
F --> G[Incrémenter convoi_id]
G --> H[Déverrouiller mutex_convoi_id]
H --> I[Verrouiller mutex_hangar]
I --> J[Trouver une ligne vide dans le hangar]
J -->|Si une ligne vide est trouvée| K[Écrire les informations du convoi dans la ligne]
J -->|Sinon| L[Continuer la recherche]
K --> M[Déverrouiller mutex_hangar]
M --> N[Libérer les sémaphores appropriés -> sem_plane, sem_truck, ou sem_boat]
N --> O[Vérifier si le nombre maximal de convois a été atteint]
O -->|Si le nombre maximal a été atteint| P[Définir le drapeau 'done']
O -->|Sinon| Q[Continuer l'exécution]
P --> R[Attendre que tous les consommateurs finissent -> en vérifiant consumers_done]
R --> S[Sortir de la boucle while]
Q --> B
